# Enable Rewrite Engine
RewriteEngine On

# Set base directory
RewriteBase /weather1.0/

# Prevent infinite loops
RewriteCond %{ENV:REDIRECT_STATUS} ^$

# Don't apply rules to existing files, directories, or symlinks
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l

# URL Rewriting Rules

# Home page
RewriteRule ^home/?$ index.php [L]

# About page
RewriteRule ^about/?$ pages/about.php [L]

# Contact page
RewriteRule ^contact/?$ pages/contact.php [L]

# API endpoints
RewriteRule ^api/recommendations/?$ api/get_recommendations.php [L]
RewriteRule ^api/weather/([^/]+)/?$ api/get_city_weather.php?city=$1 [L,QSA]

# Handlers
RewriteRule ^handlers/contact/?$ handlers/contact_handler.php [L]

# Handle errors
ErrorDocument 404 /weather1.0/404.php

# Set default character set
AddDefaultCharset UTF-8

# Disable directory browsing
Options -Indexes

# MIME types
AddType application/javascript .js
AddType text/css .css

# Cache Control for static assets
<FilesMatch "\.(css|js|jpg|jpeg|png|gif|ico)$">
    Header set Cache-Control "max-age=31536000, public"
</FilesMatch>

# Prevent accessing .htaccess file
<Files .htaccess>
    Order Allow,Deny
    Deny from all
</Files>

# Prevent accessing .env file
<Files .env>
    Order Allow,Deny
    Deny from all
</Files>
